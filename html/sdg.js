var A="";var K="";var P="";var W=["all"];var u="frequency";var U=500;var r=3;var x=7200;var a=0;var V=true;var G=true;var n=100;var s="";var q="";var Q=false;var c=false;var j=false;const Z=window.location.search;const e=new URLSearchParams(Z);if(e.has("gateway"))K=e.get("gateway");if(e.has("device"))A=e.get("device");if(e.has("scpiheight"))P=e.get("scpiheight");if(e.has("view"))W=e.getAll("view");if(e.has("demo"))c=true;var $=window.location.href;if($.includes("github.io"))c=true;var o="";function Y(){if(K){o=K}else if(!o){o="ws://"+window.location.host}console.log("wsGateway: "+o)}function z(e){if(s!=e){if(Je.includes(e)){websocket.send(JSON.stringify({action:"setDevice",argument:e}));s=e}}}function J(){field=N("devices");if(field.value<Je.length){z(Je[field.value]);D("*IDN?",true);v()}}function X(){el=document.getElementsByClassName("checkrow");for(i=0;i<el.length;i++){el[i].onclick=function(e){var t=e.currentTarget;if(t.classList.contains("green")){t.classList.remove("green");t.cells[0].firstElementChild.checked=false}else{t.classList.add("green");t.cells[0].firstElementChild.checked=true}}}}function ee(e,t){if(t==="accept"){el=document.getElementsByClassName("cb");var n=true;for(i=0;i<el.length;i++){if(el[i].checked===false){n=false}}if(n||e.shiftKey){f(true)}else{alert("You must agree to each clasue")}}else{el=document.getElementsByClassName("checkrow");for(i=0;i<el.length;i++){el[i].classList.remove("green");el[i].cells[0].firstElementChild.checked=false}alert("Launching demo mode with fake static data.\nNothing is sent to a real device.");c=true;f(false)}}document.addEventListener("DOMContentLoaded",function(){if(c){f(false);return}N("accept").onclick=function(e){ee(e,"accept")};N("decline").onclick=function(e){ee(e,"decline")};X();var e=Number(localStorage.getItem("disclaimer"));if(Date.now()-e<7654321012){f(false)}else{N("disclaimer").style.display="block"}});function f(e){if(e)localStorage.setItem("disclaimer",Date.now());N("disclaimer").style.display="none";setTimeout(()=>{_("vfdarea",false)},"900");et();ze();N("devices").onchange=function(){J()};N("screenbmp").onclick=function(){ke()};N("frequency").onclick=function(){le("toggle")};N("helppage").onmouseenter=function(){Q=true};N("helppage").onmouseleave=function(){Q=false};if(t==false){N("helppage").style.display="block"}if(-1==Re.indexOf(u))u="frequency";document.addEventListener("keydown",we);document.addEventListener("click",Oe);var t=false;W.forEach(e=>{switch(e){case"frontpanel":N("frontpanel").style.display="block";t=true;break;case"counter":me("on");t=true;break;case"tools":Ve("on");t=true;break;case"help":xe("on");t=true;break;case"all":N("frontpanel").style.display="block";me("on");Ve("on");t=true;break}})}const te={"!":"KB_FUNC1","@":"KB_FUNC2","#":"KB_FUNC3",$:"KB_FUNC4","%":"KB_FUNC5","^":"KB_FUNC6",1:"KB_NUMBER_1",2:"KB_NUMBER_2",3:"KB_NUMBER_3",4:"KB_NUMBER_4",5:"KB_NUMBER_5",6:"KB_NUMBER_6",7:"KB_NUMBER_7",8:"KB_NUMBER_8",9:"KB_NUMBER_9",".":"KB_POINT",0:"KB_NUMBER_0","-":"KB_NEGATIVE",M:"KB_MOD",S:"KB_SWEEP",B:"KB_BURST",P:"KB_PARAMETER",U:"KB_UTILITY",D:"KB_STORE_RECALL",W:"KB_WAVES",C:"KB_CHANNEL",ArrowUp:"KB_KNOB_RIGHT",ArrowLeft:"KB_LEFT",Backspace:"KB_LEFT",Enter:"KB_KNOB_DOWN",ArrowRight:"KB_RIGHT",ArrowDown:"KB_KNOB_LEFT","[":"KB_OUTPUT1","]":"KB_OUTPUT2","{":"INT_TRIGGER1","}":"INT_TRIGGER2",H:"INT_SHOWHELP",T:"INT_SHOWTOOLS",F:"INT_SHOWCOUNTER",R:"INT_REFRESH",K:"INT_BEEP",issend:"INT_SCPI_SEND",isclr:"INT_SCPI_CLEAR",icrn:"INT_CTR_REFRESH_ON",icrf:"INT_CTR_REFRESH_OFF",icon:"INT_CTR_ONOFF",icdf:"INT_CTR_DISP_FREQ",icdt:"INT_CTR_DISP_TIME",icdo:"INT_CTR_DISP_OTHER",icf:"INT_CTR_FAST",icac:"INT_CTR_AC",ichf:"INT_CTR_HFR"};var ne=["KB_MOD","KB_SWEEP","KB_BURST","KB_CHANNEL"];var ae=["KB_PARAMETER","KB_UTILITY","KB_STORE_RECALL","KB_WAVES"];var ie=ne.concat(ae);function re(e){if(ie.includes(e)){websocket.send(JSON.stringify({action:"ledHack",argument:e}))}}function se(t){ae.forEach(e=>{if(e==t){document.getElementsByName(t)[0].classList.add("onon")}else{document.getElementsByName(e)[0].classList.remove("onon")}})}function ce(e){if(typeof websocket!="object"||websocket.readyState!=1){oe()}var t=true;if(Object.values(te).includes(e)){re(e);switch(e){case"INT_SHOWHELP":Ne();break;case"INT_SHOWTOOLS":ge();break;case"INT_SHOWCOUNTER":me();break;case"INT_CTR_REFRESH_ON":le("on");break;case"INT_CTR_REFRESH_OFF":le("off");break;case"INT_BEEP":ye();break;case"INT_REFRESH":ke();break;case"INT_TRIGGER1":t=he(1);break;case"INT_TRIGGER2":t=he(2);break;case"INT_SCPI_SEND":Be();break;case"INT_SCPI_CLEAR":Qe("","clear");break;case"INT_CTR_FAST":Ee();break;case"INT_CTR_ONOFF":be();break;case"INT_CTR_DISP_FREQ":Se("f");break;case"INT_CTR_DISP_TIME":Se("t");break;case"INT_CTR_DISP_OTHER":Se("o");break;case"INT_CTR_AC":Ce("a");break;case"INT_CTR_HFR":Ce("h");break;default:var n="vkey value,"+e+",state,1";D(n,false);l(r)}if(t){fe()}else{oe()}}else{oe()}}function oe(){if(g("beep"))nt(220,.5,"square",100)}function fe(){if(g("beep"))nt(880,.5,"sine",50)}function l(e){if(e>0){Fe("On");if(t==undefined){v();t=setInterval(v,U);T=e}else{if(e>T)T=e}}else{t=clearInterval(t);T=0;Fe("Off")}}var d;var t;var T=0;function v(){var e=N("screenbmp");if(c){e.src="sample.bmp";S("screenbmp","staleinfo")}else{D("scdp",false)}if(t!=undefined){T--;if(T<=0){t=clearInterval(t);T=0;Fe("off")}}D("C1:outp?\nC2:outp?\n"+"C1:mdwv?\nC2:mdwv?\n"+"C1:btwv?\nC2:btwv?\n"+"C1:swwv?\nC2:swwv?\n",false);if(a){clearTimeout(d);d=setTimeout(()=>{R("screenbmp","staleinfo")},a*1e3)}}var m;function le(e){switch(e){case"on":p("on");break;case"off":if(m==undefined){D("FCNT?",false)}else{p("off")}break;case"toggle":if(m==undefined){p("on")}else{p("off")}break}}function p(e){if(e=="on"){if(m==undefined){m=setInterval(D,500,"FCNT?",false)}h("refreshFCNT_on");C("refreshFCNT_off");return}else{m=clearInterval(m);C("refreshFCNT_on");h("refreshFCNT_off")}}function ue(e){if(e[1].match(/AC/i)){h("acLed")}else{C("acLed")}if(e[3].match(/on/i)){h("hfrLed")}else{C("hfrLed")}if(e[5].match(/fast/i)){h("fastFCNT")}else{C("fastFCNT")}}function de(e){if(e.match(/off/i)){C("onoffFCNT")}else{h("onoffFCNT")}}function N(e){return document.getElementById(e)}function g(e){return N(e).classList.contains("green")}function h(e){S(e,"red");S(e,"yellow");R(e,"green");S(e,"black")}function Te(e){S(e,"red");R(e,"yellow");S(e,"green");S(e,"black")}function E(e){R(e,"red");S(e,"yellow");S(e,"green");S(e,"black")}function C(e){S(e,"red");S(e,"yellow");S(e,"green");R(e,"black")}function b(e){S(e,"red");S(e,"yellow");S(e,"green");S(e,"black")}function _(e,t){if(t){R(e,"cyanblack")}else{S(e,"cyanblack")}}function ve(e,t){N(e).className=t}function R(e,t){N(e).classList.add(t)}function S(e,t){N(e).classList.remove(t)}function me(e){if(e=="on"||!g("counterBut")){Ue("on");p("on")}else{Ue("off");p("off")}}var pe=0;function Ne(){switch(N("scpitext").value){case"clear":localStorage.clear();N("scpitext").value="done";break;default:if(g("helpBut")){window.scroll(0,0);xe("off")}else{xe("on");N("helppage").scrollIntoView({behavior:"smooth",block:"start"})}break}}function ge(){if(g("toolsBut")){Ve("off")}else{Ve("on")}l(r)}function he(t){var e=true;const n=["btwv","swwv"];var a="";n.forEach(e=>{if(He[e+t]=="on"){a="C"+t+":"+e.toUpperCase()+" MTRIG"}});if(a){h("trigger"+t);D(a,false)}else{E("trigger"+t);e=false}setTimeout(()=>{b("trigger"+t)},"200");l(r);return e}function Ee(){if(g("fastFCNT")){D("FCNT TYPE,SLOW")}else{D("FCNT TYPE,FAST")}l(r)}function Ce(e){if(e=="a"){if(g("acLed")){D("FCNT MODE,DC")}else{D("FCNT MODE,AC")}}if(e=="h"){if(g("hfrLed")){D("FCNT HFR,OFF")}else{D("FCNT HFR,ON")}}l(r)}function be(){if(g("onoffFCNT")){D("FCNT STATE,OFF");p("off");setTimeout(()=>{D("FCNT?",false)},500)}else{D("FCNT STATE,ON");p("on")}l(r)}function _e(e){switch(e){case"f":h("freqFCNT");C("timeFCNT");C("otherFCNT");break;case"t":C("freqFCNT");h("timeFCNT");C("otherFCNT");break;case"o":C("freqFCNT");C("timeFCNT");h("otherFCNT");break}}var F="f";const k=["frequency","reference"];const y=["period","pWidth","nWidth","gate"];const O=["deviation","duty","trigLev"];const Re=k.concat(y,O);function Se(e){var t;switch(e){case"f":t=k.indexOf(u);t=(t+1)%k.length;u=k[t];F="f";break;case"t":t=y.indexOf(u);t=(t+1)%y.length;u=y[t];F="t";break;case"o":t=O.indexOf(u);t=(t+1)%O.length;u=O[t];F="o";break}if(!g("refreshFCNT_on")){We(Pe)}}function Fe(e){if(e.match(/on/i)){h("refresh")}else{b("refresh")}}function ke(){if(t==undefined){l(x)}else{l(0)}}function ye(){if(g("beep")){b("beep")}else{h("beep");audioCtx=new(window.AudioContext||window.webkitAudioContext)}}function Oe(e){const t=e.target.nodeName==="BUTTON";if(!t)return;ce(e.target.name)}function we(e){var t=e.key;if(t.length==1){t=t.toUpperCase()}if(Q==true){if(t!="H"){return}}if(document.activeElement.id=="scpitext"){switch(t){case"Enter":Be("user");w=0;break;case"ArrowUp":if(++w<B.length){N("scpitext").value=B[w]}else{w=B.length-1}break;case"ArrowDown":if(--w>=0){N("scpitext").value=B[w]}else{N("scpitext").value="";w=-1}break}}if(t=="Enter"){if(document.activeElement.id=="macros"){Be()}}if(document.activeElement.classList.contains("nokey")){return}if(e.altKey&&e.ctrlKey&&t=="F"){console.log(e);var n=N("frequency").style.fontFamily;if(n=="FourteenSeg"){n="SevenSeg"}else{n="FourteenSeg"}N("frequency").style.fontFamily=n;return}if(e.altKey||e.ctrlKey||e.metaKey){return}if(t in te){ce(te[t]);e.preventDefault()}}var w=0;var B=[];function Be(e){var t=N("scpitext").value;var n=N("macro12").value;if(e!="user"){var a=N("macros").value;if(a>=1&&a<Ye.length){t=Ye[a]}}if(t.match(/^scdp/i)){Qe("","clear");Qe("Refusing to ask for binary junk!");return}if(t.length>0){t.split(/&/).forEach(e=>{if(n==1||n==2){e=e.replace(/^C\?:/i,`C${n}:`)}D(e,true)});l(r);if(e=="user"||V){if(B[0]!=t){B.unshift(t)}}}}function Ie(e){var t=e.split(",");var n=t[0];q=t[1];N("model").innerHTML=q;document.title=`${q}@${s}`}function Le(e){var t;if(t=e.match(/^ROSC (int|ext),10MOUT,(on|off)/i)){var n=t[1];var a=t[2];if(n.match(/^ext/i)){_("extrefLed",true)}else{_("extrefLed",false)}}}function Me(e){var t;if(t=e.match(/^C(\d):OUTP (on|off),/i)){var n=t[1];var a=t[2].toLowerCase();if(a.match(/^on/i)){h("ch"+n)}else{C("ch"+n)}}}var I={};var He={};function De(e){var t;if(t=e.match(/^C(\d):(MDWV|SWWV|BTWV) STATE,(on|off),*/i)){var n=t[1];var a=t[2].toLowerCase();var i=t[3].toLowerCase();I[a+n]=i}if(Object.keys(I).length==6){if(Object.values(He).toString()!=Object.values(I).toString()){const r=["mdwv","btwv","swwv"];r.forEach(e=>{var t=I[e+"1"]+I[e+"2"];S(e,"offoff");S(e,"offon");S(e,"onoff");S(e,"onon");R(e,t)});He=Object.assign({},I);I={}}}}var Ae=["uS","sec","MHz","Hz","pcent"];function Ke(){Re.forEach(e=>{if(e==u){_(e+"Led",true)}else{_(e+"Led",false)}});Ae.forEach(e=>{_(e,false)});switch(u){case"frequency":case"reference":_("Hz",true);break;case"duty":_("pcent",true);break;case"deviation":case"trigLev":break;default:_("sec",true);break}}function L(e){N("frequency").innerHTML=e}var Pe;function We(e){var t="Counter!Off!";if(e.startsWith("FCNT STATE,OFF")){de("Off");L(t)}if(e.startsWith("FCNT STATE,ON")){Pe=e;de("On");var n=e.split(",");Ke();_e(F);ue(n.slice(16,22));switch(u){case"frequency":var t=n[3];var a=t.match(/^\d+(\.\d+)?/);t=a[0];t=Number(t)/1;var i=9;if(t>1e6){t=t/1e6;_("MHz",true);i=9}else if(t>1e3){_("MHz",false);i=6}else if(t>1){_("MHz",false);i=9}t=t.toLocaleString("en-US",{minimumFractionDigits:i,maximumFractionDigits:i});L(t);break;case"reference":var r=Number(n[7].replace(/HZ/,""));if(r>1e6){r=r/1e6;_("MHz",true)}else{_("MHz",false)}r=r.toLocaleString("en-US",{minimumSignificantDigits:6,maximumSignificantDigits:6,roundingMode:"trunc"});L(r);break;case"period":case"pWidth":case"nWidth":case"gate":var s=Number(n[11].replace(/S$/,""));var c=Number(n[13].replace(/S$/,""));var o;var f=6;switch(u){case"period":o=s+c;break;case"pWidth":o=s;break;case"nWidth":o=c;break;case"gate":f=4;if(n[21].match(/fast/i)){o=.5}else{o=1};break}if(o<1e-6){o*=1e6;_("uS",true)}o=o.toLocaleString("en-US",{minimumSignificantDigits:f,maximumSignificantDigits:f,roundingMode:"halfExpand"});L(o);break;case"duty":duty=n[5];duty=(Math.round(duty*100)/100).toFixed(2);L(duty);break;case"deviation":var l=n[15].replace(/ppm/,"")*1e3;if(Math.abs(l)<1e7){l=l.toLocaleString("en-US",{minimumFractionDigits:3,maximumFractionDigits:3,roundingMode:"trunc"})}else{l="out!of!range"}L(l);break;case"trigLev":trig=Number(n[9].replace(/V$/,""));trig=trig.toFixed(3);L(trig+"!v!");break}}}function Ue(e){if(e=="on"){h("counterBut");N("counter").style.display="block"}else{b("counterBut");N("counter").style.display="none"}}function xe(e){if(e=="on"){h("helpBut");N("helppage").style.display="block"}else{b("helpBut");N("helppage").style.display="none"}}function Ve(e){if(e=="on"){h("toolsBut");N("scpitools").style.display="block"}else{b("toolsBut");N("scpitools").style.display="none"}}function M(e){switch(e){case"green":h("txbut");h("txFCNT");break;case"yellow":Te("txbut");Te("txFCNT");break;case"red":E("txbut");E("txFCNT");break;default:b("txbut");C("txFCNT");break}}function H(e){switch(e){case"green":h("rxbut");break;case"yellow":Te("rxbut");break;case"red":E("rxbut");break;default:b("rxbut");break}}var Ge=0;function qe(e,t){if(e.toString().startsWith("4")){var n=(new Date).getTime()/1e3;if(n-Ge>5){l(0);p("off");alert(e+": "+t);Ge=n;M("")}}else{alert(t)}}function Qe(e,t){var n=N("scpireplies");var a=N("csvtable");for(var i=0;i<a.rows.length;){a.deleteRow(i)}if(t=="clear"){n.innerHTML="";return}if(e.length==0)return;if(G==true){n.innerHTML+=`<div class="nokey scpireply">${e}</div>`}else{n.innerHTML=`<div class="nokey scpireply">${e}</div>`}e=e.replace(" ",",");var r=e.split(/,/);var s=r.length;if(s%2==1){s=r.unshift(r[0]);r[1]=""}for(var i=0;i<s;i+=2){var c=a.insertRow(-1);var o=c.insertCell(0);var f=c.insertCell(1);o.innerHTML=r[i];f.innerHTML=r[i+1]}}var je=`Siglent Technologies,SDGDEMO!,SDG42424242242,2.01.01.38
C1:OUTP ON,LOAD,50,POWERON_STATE,0,PLRT,NOR
C2:OUTP ON,LOAD,50,POWERON_STATE,0,PLRT,NOR
C1:MDWV STATE,ON,FM,MDSP,ARB,INDEX,63,SRC,INT,FRQ,1HZ,DEVI,50000HZ,CARR,WVTP,SINE,FRQ,108000000HZ,AMP,0.632551V,AMPVRMS,0.223607Vrms,AMPDBM,0dBm,OFST,0V,PHSE,0
C2:MDWV STATE,OFF
C1:BTWV STATE,OFF
C2:BTWV STATE,OFF
C1:SWWV STATE,OFF
C2:SWWV STATE,ON,TIME,23S,STOP,773999HZ,START,773999HZ,TRSR,INT,TRMD,OFF,SWMD,LINE,DIR,UP,SYM,5419472.01183249,MARK_STATE,OFF,MARK_FREQ,0HZ,IDLE_FREQ,START_FREQ,CARR,WVTP,SINE,FRQ,773999HZ,AMP,0.632551V,AMPVRMS,0.223607Vrms,AMPDBM,-7.47755e-07dBm,OFST,0V,PHSE,0
FCNT STATE,ON,FRQ,10000000.07HZ,DUTY,46.5815,REFQ,1e+07HZ,TRG,4.38538e-15V,PW,4.65815e-08S,NW,5.34185e-08S,FRQDEV,0.00667211ppm,MODE,AC,HFR,OFF,TYPE,SLOW 
`;function Ze(e,t){if(t)Qe(e,"");lines=e.split("\n");lines.forEach(e=>{if(e.startsWith("FCNT ")){if(g("refreshFCNT_on")){We(e)}else{We(Pe)}}if(e.startsWith("Siglent ")){Ie(e)}if(e.match(/^C\d:(MDWV|BTWV|SWWV) /i)){De(e)}if(e.match(/^C\d:OUTP /)){Me(e)}if(e.match(/^ROSC /)){Le(e)}})}function $e(e,t){M("yellow");if(t){Ze("DEMO STATE,ON,FRQ,10000000.07HZ,DUTY,46.5815,"+"REFQ,1e+07HZ,TRG,4.38538e-15V,PW,4.65815e-08S,"+"NW,5.34185e-08S,FRQDEV,0.00667211ppm,"+"MODE,AC,HFR,OFF,TYPE,SLOW",t)}else{Ze(je,t)}setTimeout(()=>{M("")},200);return}function D(e,t){if(e=="")return;if(c){$e(e,t);return}var n="scpiCmd";if(e.includes("?")){n="scpiQuery"}else if(e.match(/^scdp/i)){n="scdp"}else{n="scpiCmd"}if(websocket.readyState==1){M("green");setTimeout(()=>{M("")},100);websocket.send(JSON.stringify({action:n,argument:e,updateResponse:t}))}else{M("red")}}var Ye=["Free Text"];function ze(){const e=new XMLHttpRequest;e.open("GET","sdg-macros.json");e.send();e.responseType="json";e.onload=()=>{if(e.readyState==4&&e.status==200){const i=e.response;var n=N("macros");var a=1;Object.keys(i).forEach(e=>{Ye.push(i[e]);var t=document.createElement("option");t.text=e;t.value=a++;n.add(t)})}else{console.log(`Error readMacros() : ${e.status}`)}}}var Je=[];function Xe(n){data=Object.keys(n["value"]);var a=N("devices");a.length=0;s=n["currentDevice"];var i=0;data.forEach(e=>{Je.push(e);var t=document.createElement("option");t.text=e;t.value=i++;if(e==n["currentDevice"]){t.selected=true}a.add(t)})}function et(){const t=new XMLHttpRequest;t.open("GET","sdg-config.json");t.send();t.responseType="json";t.onload=()=>{if(t.readyState==4&&t.status==200){const e=t.response;if("updateTime"in e)U=e.updateTime;if("smallUpdateCycles"in e)r=e.smallUpdateCycles;if("longUpdateCycles"in e)x=e.longUpdateCycles;if("idleTimeout"in e)a=e.idleTimeout;if("macrosUpdateHistory"in e)V=e.macrosUpdateHistory;if("scpiResultsAppend"in e)G=e.scpiResultsAppend;if("scpiHeightPx"in e)n=Number(e.scpiHeightPx);if("wsGateway"in e)o=e.wsGateway;tt();Y();it()}else{console.log(`Error readConfig() : ${t.status}`)}}}function tt(){if(P>0)n=P;N("42").style.height=n+"px";N("43").style.height=n+"px"}function nt(e,t,n,a){if(!audioCtx)return;var i=audioCtx.createOscillator();var r=audioCtx.createGain();i.connect(r);r.connect(audioCtx.destination);r.gain.value=t;i.frequency.value=e;i.type=n;i.start();setTimeout(()=>{i.stop()},a)}function at(e){N("userCount").innerHTML=e}function it(){console.log("Trying to open a WebSocket connection...");websocket=new WebSocket(o);websocket.onopen=st;websocket.onclose=ct;websocket.onmessage=ot}var rt=0;function st(){console.log("ws opened");M("");H("");rt=0;websocket.send(JSON.stringify({action:"getDevices"}))}function ct(){console.log("ws closed");M("red");H("red");if(rt++<5){setTimeout(()=>{it()},500)}else{confirm("Cannot connect to sdg proxy.\nReload page to retry.")}}function ot(e){H("green");setTimeout(()=>{H("")},100);const t=JSON.parse(e.data);if(t.hasOwnProperty("currentDevice")){if(s!=t["currentDevice"]){s=t["currentDevice"]}}switch(t.type){case"error":console.log(t.value);H("red");break;case"users":at(t.count);break;case"scdp":var n=N("screenbmp");n.src="data:image/png;base64,"+t.value;S("screenbmp","staleinfo");if(a){clearTimeout(d);d=setTimeout(()=>{R("screenbmp","staleinfo")},a*1e3)}break;case"scpi":Ze(t.value,t.updateResponse);break;case"getDevices":Xe(t);if(!j){j=true;if(A){z(A)}v();D("*IDN?",true)}break;case"ledHack":se(t.value);break;default:console.error("unsupported msg",t)}}
